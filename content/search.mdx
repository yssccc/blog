---
title: '검색 기능 추가하기'
date: '2025-11-12'
thumbnail: '/thumbnails/search.png'
categories: ['Next.js']
description: '검색 기능을 구현하면서 정리한 내용입니다.'
---

## 구현 방식

Header에서는 `getAllPosts()`로 MDX파일을 읽어와야 했기 때문에 **서버 컴포넌트로** 설계하였습니다. 하지만 검색 기능을 추가하면서 검색 버튼 클릭같은 UI 상호작용은 **클라이언트 컴포넌트에서만** 처리할 수 있는 문제가 있었습니다.

이를 위해 **서버 컴포넌트+클라이언트 컴포넌트 분리 방식**을 사용하기로 했습니다.

- `Header` → 서버에서 데이터 준비만 함
- `HeaderClient` → 검색 버튼, 모달 열기/닫기
- `SearchModal` → 실제 검색 기능, 필터링, UI 렌더링

```tsx
// components/search/SearchModal.tsx
const filtered = debouncedKeyword
  ? posts.filter((p) => {
      const lower = debouncedKeyword.toLowerCase();
      return (
        p.title.toLowerCase().includes(lower) ||
        p.content.toLowerCase().includes(lower)
      );
    })
  : [];
```

검색 기준:

- 제목 포함 여부
- 내용 포함 여부

**미리 읽어온 전체 posts 배열에서 문자열 검색만 수행하여** API 요청 없이 빠릅니다.

## Debounce

사용자가 입력할 때마다 매 글자 입력 시마다 필터링이 실행되면 매 타이핑마다 `posts.filter()` 실행되고, 글 수가 많아질수록 비용이 증가하기 때문에 debounce를 적용하였습니다.

```tsx
useEffect(() => {
  const timer = setTimeout(() => {
    setDebouncedKeyword(keyword);
  }, 300);
  return () => clearTimeout(timer);
}, [keyword]);
```

> 디바운스(Debounce)는 사용자가 연속으로 여러 번 실행하는 동작을
> ‘마지막 한 번만’ 처리하도록 지연시키는 기술입니다.

`keyword`는 즉시 업데이트되지만 300ms 동안 타이핑이 멈췄을 때만
`debouncedKeyword`가 갱신되어 불필요한 렌더링과 검색을 최소화할 수 있습니다.
